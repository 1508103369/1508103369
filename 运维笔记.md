简述
自建机房：不易扩展，前期投入成本大（机房环境，硬件设备，运维人员）

云服务：资源弹性拓展收缩 

IaaS：基础设施即服务 提供按需付费的云计算，存储，数据中心，网络等，例如阿里云，AWS，AZURE等等

PaaS：提供硬件和软件工具，使开发人员更轻松地快读创建web或移动应用

SaaS软件即服务：基于云的应用，被授予企业或个人通过网络访问使用。如百度云盘，钉钉

<img src="https://github.com/1508103369/image/blob/typora/image-20231206104512475.png?raw=true" style="zoom:33%;" />

[C:\~]$ ssh root@192.168.177.10 -p 2002   登录，【root】那里是用户名  -p后面是端口号

```shell
[root@chen ~]# w //查询当前账户
 15:39:54 up 28 min,  1 user,  load average: 0.00, 0.01, 0.04
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
root     pts/1    192.168.177.1    15:11    2.00s  0.03s  0.01s w
[root@chen ~]# who
root     pts/1        2023-12-06 15:11 (192.168.177.1)

```

## Git使用

```bash
先在项目目录打开git-bash
git add .    //把当前目录下所有文件加到暂存区
git commit -m "test"     //声明（必填”内容随意“）
git push   //推送到github服务器
```

<img src="https://raw.githubusercontent.com/1508103369/image/typora/image-20231207140613784.png" alt="image-20231207140613784" style="zoom: 50%;" />

下面的url从github获取

```bash
 git clone https://github.com/1508103369/1508103369.git   //下载1508103369仓库到本地
Cloning into '1508103369'...
remote: Enumerating objects: 33, done.
remote: Counting objects: 100% (33/33), done.
remote: Compressing objects: 100% (23/23), done.
remote: Total 33 (delta 9), reused 21 (delta 5), pack-reused 0
Receiving objects: 100% (33/33), 9.45 MiB | 3.66 MiB/s, done.
Resolving deltas: 100% (9/9), done.    //下载完成后在文件夹中默认显示main分支的内容

15081@hello MINGW64 ~/Desktop/test/1508103369 (main)
$ ls
README.md

15081@hello MINGW64 ~/Desktop/test/1508103369 (main)
$ git branch -a   //查看所有分支情况
* main
  remotes/origin/HEAD -> origin/main
  remotes/origin/main
  remotes/origin/master

15081@hello MINGW64 ~/Desktop/test/1508103369 (main)
$ git checkout master        //切换到master分支
Switched to a new branch 'master'
branch 'master' set up to track 'origin/master'.

15081@hello MINGW64 ~/Desktop/test/1508103369 (master)
$ ls    //这样才会在文件夹中显示别的分支文件
C++学习笔记.md                   K8s学习笔记.md    小程序开发.md  数据结构.md
K8S教程深入浅出_unprotected.pdf  c语言学习笔记.md  操作系统.docx  运维笔记.md
```



# 运维笔记



## 离线安装

使用scp方式讲本地的包推送到目标服务器

```bash
scp nginx*.rpm user@目标ip:目标绝对路径
如scp nginx_1.18.0-6ubuntu14.4_amd64.deb root@192.168.177.20:/home
```



## top监视系统性能

1. **在 `top` 中执行命令**：
   - 在 `top` 中，你可以使用一些快捷键进行不同的操作。例如：
     - `q`: 退出 `top`。
     - `k`: 杀死一个进程。
     - `u`: 显示指定用户的进程。//输入的是用户名
     - `H`: 显示/隐藏线程。
     - `f`: 选择显示的列。 按下 `Space` 键来切换该列的显示状态。显示的列前面的方框会变为星号 `*`，表示该列已经被选择。
   - 按下 `?` 键可以查看更多的快捷键。
2. **退出 `top`**：
   - 要退出 `top`，可以按下 `q` 键。

```shell
top - 16:13:07 up 13 days,  2:11,  1 user,  load average: 0.15, 0.24, 0.17
//    当前时间	状态  已运行时间      当前登录用户数     系统负载，分别表示1分钟、5分钟和15分钟的平均负载。
Tasks: 203 total,   1 running, 201 sleeping,   1 stopped,   0 zombie //任务信息
%Cpu(s):  0.3 us,  0.0 sy,  0.0 ni, 99.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
MiB Mem :   1896.2 total,     96.7 free,    660.1 used,   1139.5 buff/cache
MiB Swap:    935.4 total,    229.3 free,    706.1 used.    782.9 avail Mem 
```

## htop

<img src="https://raw.githubusercontent.com/1508103369/image/typora/image-20231215095147560.png" alt="image-20231215095147560" style="zoom:50%;" />

<img src="https://raw.githubusercontent.com/1508103369/image/typora/image-20231215095223091.png" alt="image-20231215095223091" style="zoom:50%;" />

```bash
PID：进程标志号，是非零正整数
USER：进程所有者的用户名
PR：进程的优先级别
NI：进程的优先级别数值
VIRT：进程占用的虚拟内存值
RES：进程占用的物理内存值
SHR：进程使用的共享内存值
S：进程的状态，其中S表示休眠，R表示正在运行，Z表示僵死状态，N表示该进程优先值是负数
%CPU：该进程占用的CPU使用率
%MEM：该进程占用的物理内存和总内存的百分比
TIME+：该进程启动后占用的总的CPU时间
COMMAND：进程启动的启动命令名称
```

```
搜索进程：鼠标点击Search 或者按下F3 或者输入”/”， 输入进程名进行搜索，例如搜索ssh
过滤器：按下F4，进入过滤器，相当于关键字搜索，不区分大小写，例如过滤dev。
显示树形结构：输入”t”或按下F5，显示树形结构
search和filter的区别：search会将光标定位到符合条件的进程上，通过F3键进行逐个查找；而filter会直接将符合条件的进程筛选出来。search和filter都使用ESC键来取消功能。
```



## ps当前进程信息

```bash
显示所有进程
ps -e  or ps aux
每一行代表一个进程。
第一列是进程的PID（进程ID）。
第二列是TTY（终端）信息。
第三列是进程已运行的时间。
ps -u username   //显示特定用户的进程：
ps -e --forest   //显示进程树
ps -eLF          //显示进程线程信息(可以显示进程启动时间，父进程，子进程..)
watch ps aux     //实时刷新进程信息（和top类似）
```

## iftop网络流量监控

```bash
ifconfig     //先查用的是哪个网卡，直接输入iftop默认看的是第一块网卡
$ iftop -i eth0 -nNB -m 10M    一般直接iftop -i eth0
-i 指定网卡，
-n 代表主机通过ip显示不走DNS
-N 只显示连接端口号，不显示端口对应的服务名称(不加会显示如ssh这样的服务名称，不便于排查)
-B 指定显示单位为Kb，默认是bit，太小！
-m 设置输出界面中最上面的流量刻度最大值，流量刻度分5个大段显示
显示每个连接的总流量    ## 进入界面后按下 T显示
指定 ip 172.17.1.158 的流量   ##进入界面后按下 l 后,再输入 172.17.1.158 并回车)
显示端口号			##（添加 -P 参数，进入交互界面可通过按 p 打开或者关闭）
显示流量进度条        ## 进入界面后按下 L 
-B 以bytes为单位显示流量(默认是bits)，如：# iftop -B

按h切换是否显示帮助;
按n切换显示本机的IP或主机名;
按s切换是否显示本机的host信息;
按d切换是否显示远端目标主机的host信息;
按t切换显示格式为2行/1行/只显示发送流量/只显示接收流量;
按N切换显示端口号或端口服务名称;
按S切换是否显示本机的端口信息;
按D切换是否显示远端目标主机的端口信息;
按p切换是否显示端口信息;
按P切换暂停/继续显示;
按b切换是否显示平均流量图形条;
按B切换计算2秒或10秒或40秒内的平均流量;
按T切换是否显示每个连接的总流量;
按l打开屏幕过滤功能，输入要过滤的字符，比如ip,按回车后，屏幕就只显示这个IP相关的流量信息;
按L切换显示画面上边的刻度;刻度不同，流量图形条会有变化;
按j或按k可以向上或向下滚动屏幕显示的连接记录;
按1或2或3可以根据右侧显示的三列流量数据进行排序;
按<根据左边的本机名或IP排序;
按>根据远端目标主机的主机名或IP排序;
按o切换是否固定只显示当前的连接;
按f可以编辑过滤代码，这是翻译过来的说法，我还没用过这个！
按!可以使用shell命令，这个没用过！没搞明白啥命令在这好用呢！
按q退出监控。

TX：发送流量
RX：接收流量
TOTAL：总流量
Cumm：运行iftop到目前时间的总流量
peak：流量峰值
rates：分别表示过去 2s 10s 40s 的平均流量
8Mb=1MB
```

## netstat查看服务及监听端口

```bash

[root@localhost ~]# netstat -ntlp   //查看当前所有tcp端口·
[root@localhost ~]# netstat -ntulp | grep 80   //查看所有80端口使用情况·
[root@localhost ~]# netstat -an | grep 3306   //查看所有3306端口使用情况·
[root@localhost ~]# netstat -nlp |grep LISTEN   //查看当前所有监听端口·
```



## B站运维技巧

```bash
rpm -ql nginx //cenots中列出nginx所有的相关文件路径
sudo find / -iname "*nginx*"  //ubuntu没有上面的功能，只能用这个命令代替一下
```

LAMP=linux+apache（nginx）+mysql+php/python

```bash
root@chen:~# iptables -F //清空所有防火墙策略
```

```bash
[root@chen ~]$cat /etc/os-release   //查看目前的系统相关信息
```

```bash
[root@chen ~]$lsof -i :80 //可以查看80端口被哪个程序占用了
```

```bash
netstat -tunlp  //查看所有的端口占用信息
```

### LAMP搭建

```
systemctl stop firewalld
[root@chen ~]$lsof -i :80 //查看80端口是否被占用
yum -y install httpd  //安装apache
systemctl start httpd
yum -y install mariadb-server mariadb //安装mysql服务
systemctl start mariadb //启动mysql服务
```

```bash
[root@chen ~]$mysql  -uroot -p //进入mysql
MariaDB [(none)]> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| test               |
+--------------------+
4 rows in set (0.00 sec)

MariaDB [(none)]> use mysql;
MariaDB [mysql]> show tables;
+---------------------------+
| Tables_in_mysql           |
+---------------------------+
| columns_priv              |
| db                        |
| event                     |
| func                      |
| general_log               |
| help_category             |
| help_keyword              |
| help_relation             |
| help_topic                |
| host                      |
| ndb_binlog_index          |
| plugin                    |
| proc                      |
| procs_priv                |
| proxies_priv              |
| servers                   |
| slow_log                  |
| tables_priv               |
| time_zone                 |
| time_zone_leap_second     |
| time_zone_name            |
| time_zone_transition      |
| time_zone_transition_type |
| user                      |
+---------------------------+
24 rows in set (0.00 sec)

MariaDB [mysql]> select user,password,host from user;
+--------+-------------------------------------------+-----------+
| user   | password                                  | host      |
+--------+-------------------------------------------+-----------+
| root   |                                           | localhost |
| root   |                                           | chen      |
| root   |                                           | 127.0.0.1 |
| root   |                                           | ::1       |
|        |                                           | localhost |
|        |                                           | chen      |
| myuser | *FABE5482D5AADF36D028AC443D117BE1180B9725 | %         |
+--------+-------------------------------------------+-----------+
7 rows in set (0.00 sec)
MariaDB [mysql]> SET PASSWORD FOR 'root'@'localhost' = PASSWORD('123123');
Query OK, 0 rows affected (0.00 sec) //修改root的登录密码

MariaDB [mysql]> GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'your-root-password';
Query OK, 0 rows affected (0.00 sec) 

MariaDB [mysql]> FLUSH PRIVILEGES;
Query OK, 0 rows affected (0.00 sec)  //配置允许使用root用户从外部链接

CREATE USER 'myuser'@'%' IDENTIFIED BY 'mypassword';
GRANT ALL PRIVILEGES ON mydb.* TO 'myuser'@'%';
FLUSH PRIVILEGES;  //创建非root用户远程链接

```



```shell
yum install -y zlib-devel libxml2-devel libjpeg-devel libjpeg-turbo-devel libiconv-devel freetype-devel libpng-devel l libxslt-devel libtool-ltdl-devel pcre pcre-devel apr apr-devel zlib-devel gcc make -y  //安装php依赖
yum install php php-fpm php-mysql -y //安装php
使php和apache结合
[root@chen ~]$vim /etc/httpd/conf/httpd.conf
修改以下部分
DocumentRoot "/var/www/html"
    TypesConfig /etc/mime.types
    AddType application/x-httpd-php .php
    AddType application/x-httpd-php-source .phps
    DirectoryIndex index.php index.html：
这是 Apache 服务器的一些配置信息，主要包括 MIME 类型配置、PHP 文件处理方式配置以及目录索引文件设置。具体来看：
TypesConfig /etc/mime.types： 这行指示 Apache 服务器使用位于 /etc/mime.types 的文件来确定传送给客户端的文件（或 URL）的媒体类型 (MIME 类型)。MIME 类型是一种标准，比如文本文件通常是 text/plain，HTML 文件是 text/html，JPG 图像文件是 image/jpeg。
AddType application/x-httpd-php .php： 表示添加一个新的 MIME 类型 application/x-httpd-php，并将其关联到 .php 文件扩展名。这表示当 Apache 服务器看到一个 .php 文件扩展名时，它会知道需要使用 PHP 处理器处理内容，并作为结果返回。
AddType application/x-httpd-php-source .phps： 这也是添加一个新的 MIME 类型，但这次关联到 .phps 文件扩展名。.phps 文件通常用来显示 PHP 源代码，因此这行配置告诉 Apache 需要以源代码形式处理这类文件。
DirectoryIndex index.php index.html： 这行指示 Apache 在一个目录中寻找默认的索引文件。当你访问一个目录（没有指定特定的文件）时，Apache 将尝试首先提供 index.php 文件，如果不存在，再尝试 index.html 文件。这行配置可以根据你实际需要的在列一个或多个文件，优先级从左到右逐渐降低。
```

```bash
修改/var/www/html的index.php文件
    <meta charset=utf8>
    我是新的首页，你好兄弟
    <?php
    phpinfo();
    ?>
打开网页，能在线就可以了
```

